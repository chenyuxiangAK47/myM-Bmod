# 崩溃诊断和修复

## 崩溃信息总结

从崩溃日志分析：
- **崩溃时间**: 2025-12-11 08:26:44
- **错误代码**: 0xC0000005 (访问违规 - Access Violation)
- **崩溃位置**: 游戏初始化阶段，正在创建英雄模板
- **Mod已加载**: MyMod的SubModule.xml已成功加载

## 可能的原因

1. **XSLT文件问题**: `clear_old_upgrade_paths.xslt` 中的XPath表达式可能过长，导致XSLT处理器出现问题
2. **与其他mod冲突**: 你加载了很多mod，可能与某些mod冲突
3. **XML格式错误**: 某个XML文件可能有格式问题

## 修复步骤

### 步骤1: 临时禁用clear_old_upgrade_paths.xslt

在 `SubModule.xml` 中注释掉以下部分：

```xml
<!-- 清除旧兵种的升级路径引用（必须最先加载） -->
<!-- <XmlNode>
    <XmlName id="NPCCharacters" path="clear_old_upgrade_paths" type="XSLT"/>
    ...
</XmlNode> -->
```

### 步骤2: 测试游戏是否能启动

如果游戏能正常启动，说明问题在 `clear_old_upgrade_paths.xslt`。

### 步骤3: 如果还是崩溃，逐个禁用其他XSLT文件

逐个注释掉其他XSLT文件，找出问题文件。

### 步骤4: 检查XML文件格式

确保所有 `*_troops_new.xml` 文件格式正确，没有未闭合的标签。

## 已修复的问题

1. ✅ 简化了 `clear_old_upgrade_paths.xslt` 的XPath表达式
2. ✅ 注释掉了未编译的C# SubModuleClass配置

## 建议

如果问题持续，建议：
1. 先禁用所有XSLT文件，只保留XML兵种定义
2. 如果游戏能启动，再逐个启用XSLT文件
3. 检查是否有其他mod与我们的mod冲突




